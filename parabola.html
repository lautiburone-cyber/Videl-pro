<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estación del Bodeguero</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Roboto:wght@400;700&display=swap');

        /* Animaciones */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-pop { animation: fadeIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }

        /* Fondo de Madera (CSS Puro) */
        .wood-texture {
            background-color: #5d4037;
            background-image: 
                repeating-linear-gradient(45deg, rgba(255,255,255,0.05) 0px, rgba(255,255,255,0.05) 2px, transparent 2px, transparent 8px),
                linear-gradient(to bottom, #3e2723, #5d4037);
            box-shadow: inset 0 0 100px rgba(0,0,0,0.8);
        }

        /* Efecto Papel Realista */
        .paper-sheet {
            background-color: #fffdf5;
            background-image: radial-gradient(#e2e8f0 1px, transparent 1px);
            background-size: 20px 20px;
            box-shadow: 
                0 4px 6px -1px rgba(0, 0, 0, 0.1), 
                0 2px 4px -1px rgba(0, 0, 0, 0.06),
                0 0 0 1px rgba(0,0,0,0.05),
                1px 1px 0 rgba(0,0,0,0.1) inset;
            border-radius: 2px;
            position: relative;
            transform: rotate(-0.5deg);
            transition: transform 0.3s ease;
        }
        .paper-sheet:hover { transform: rotate(0deg) scale(1.005); z-index: 10; }
        
        /* Tipografía Manuscrita */
        .font-hand { font-family: 'Patrick Hand', cursive; }
        
        /* Cursor de Juego */
        .cursor-scope { cursor: crosshair; }

        /* Scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 8px; }
        .custom-scroll::-webkit-scrollbar-track { background: #f1f5f9; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    </style>
</head>
<body class="wood-texture min-h-screen flex flex-col items-center justify-center p-4 font-sans text-slate-800 overflow-x-hidden">

    <!-- Contenedor Principal (Escritorio) -->
    <div class="w-full max-w-7xl relative">
        
        <!-- Título tipo Cartel de Madera -->
        <div class="mb-6 text-center transform -rotate-1">
            <div class="inline-block bg-[#3e2723] text-[#ffecb3] px-8 py-3 rounded-lg border-4 border-[#5d4037] shadow-xl relative">
                <div class="absolute top-0 left-0 w-full h-full border border-[#ffffff33] rounded pointer-events-none"></div>
                <!-- Clavos -->
                <div class="absolute top-2 left-2 w-2 h-2 rounded-full bg-[#1a100e] shadow-inner"></div>
                <div class="absolute top-2 right-2 w-2 h-2 rounded-full bg-[#1a100e] shadow-inner"></div>
                <div class="absolute bottom-2 left-2 w-2 h-2 rounded-full bg-[#1a100e] shadow-inner"></div>
                <div class="absolute bottom-2 right-2 w-2 h-2 rounded-full bg-[#1a100e] shadow-inner"></div>
                
                <h1 class="text-3xl md:text-4xl font-bold tracking-wider font-hand flex items-center gap-3">
                    <i data-lucide="wine" class="w-8 h-8"></i>
                    LA BODEGA MATEMÁTICA
                    <i data-lucide="calculator" class="w-8 h-8"></i>
                </h1>
            </div>
        </div>

        <div class="grid grid-cols-1 xl:grid-cols-12 gap-6 items-start">
            
            <!-- SECCIÓN 1: EL GRÁFICO (Papel Grande) -->
            <div class="xl:col-span-5 paper-sheet p-1 shadow-2xl origin-top-left rotate-1">
                <!-- Cinta adhesiva simulada -->
                <div class="absolute -top-3 left-1/2 -translate-x-1/2 w-32 h-8 bg-yellow-100/50 backdrop-blur-sm shadow-sm rotate-2 z-20 pointer-events-none"></div>
                
                <div class="bg-white/80 p-4 h-full relative">
                    <h2 class="font-hand text-2xl text-slate-700 mb-2 border-b-2 border-slate-300 pb-1 flex justify-between">
                        <span>Gráfico de Proporcionalidad</span>
                        <span class="text-sm font-sans text-slate-400 mt-2">f(x) = 60/x</span>
                    </h2>
                    <div class="relative h-[400px] w-full">
                        <canvas id="wineChart"></canvas>
                    </div>
                    <p class="text-center font-hand text-slate-500 mt-2 text-lg">"A mayor envase, menos botellas..."</p>
                </div>
            </div>

            <!-- SECCIÓN 2: DATOS (Libreta) -->
            <div class="xl:col-span-3 flex flex-col gap-4">
                
                <!-- Calculadora de Papel -->
                <div class="paper-sheet p-4 rotate-2 shadow-xl bg-yellow-50">
                    <div class="flex items-center gap-2 mb-3 text-amber-800 font-bold border-b border-amber-200 pb-2">
                        <i data-lucide="sigma" class="w-5 h-5"></i>
                        <span class="font-hand text-xl">Cuentas del Bodeguero</span>
                    </div>
                    
                    <div id="calcBox" class="min-h-[140px] flex flex-col justify-center items-center text-center">
                        <div id="calcDefault" class="text-slate-500 font-hand text-lg animate-pulse">
                            (Señala la línea azul...)
                        </div>
                        <div id="calcActive" class="hidden w-full">
                            <div class="bg-white border-2 border-slate-800 p-3 rounded font-mono shadow-inner mb-2 transform scale-100 transition-transform">
                                <div class="text-xs text-slate-500 text-left">CAPACIDAD (L)</div>
                                <div class="text-2xl font-bold text-slate-800 text-right" id="valVol">0.00</div>
                            </div>
                            <div class="text-2xl font-bold text-amber-700 my-1">⬇ REPARTE EN ⬇</div>
                            <div class="bg-slate-800 border-2 border-slate-600 p-3 rounded font-mono shadow-lg text-green-400">
                                <div class="text-xs text-slate-400 text-left">CANTIDAD ENVASES</div>
                                <div class="text-3xl font-bold text-right neon-text" id="valCant">0</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabla (Clipbord) -->
                <div class="bg-[#4a3627] p-2 rounded-lg shadow-xl relative transform -rotate-1">
                    <!-- Clip metálico -->
                    <div class="absolute -top-4 left-1/2 -translate-x-1/2 w-20 h-8 bg-gradient-to-b from-gray-300 to-gray-400 rounded-t-lg z-20 shadow-md"></div>
                    
                    <div class="bg-white rounded p-3 min-h-[250px] shadow-inner relative mt-4">
                        <table class="w-full text-sm font-hand text-lg">
                            <thead>
                                <tr class="border-b-2 border-slate-800">
                                    <th class="text-left pb-1">Litros</th>
                                    <th class="text-right pb-1">Envases</th>
                                </tr>
                            </thead>
                            <tbody id="dataTableBody" class="divide-y divide-slate-200">
                                <!-- JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- SECCIÓN 3: JUEGO (Arcade Retro) -->
            <div class="xl:col-span-4 relative group perspective-1000">
                <div class="bg-slate-900 rounded-xl p-2 border-b-8 border-r-8 border-slate-950 shadow-2xl transform transition-transform duration-300 hover:rotate-0 rotate-1 relative overflow-hidden">
                    
                    <!-- Header Arcade -->
                    <div class="bg-gradient-to-r from-purple-900 to-indigo-900 p-3 rounded-t-lg flex justify-between items-center border-b-4 border-slate-950 relative overflow-hidden">
                        <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-30"></div>
                        <div class="flex flex-col z-10">
                            <span class="text-yellow-400 font-black text-xl tracking-widest drop-shadow-[2px_2px_0_rgba(0,0,0,1)] uppercase italic">Grape Smash</span>
                            <span class="text-xs text-purple-200 font-mono">HIGH SCORE: <span id="highScore">0</span></span>
                        </div>
                        <div class="bg-black/50 px-4 py-2 rounded border border-purple-500/50">
                            <span class="text-green-400 font-mono text-2xl font-bold drop-shadow-[0_0_5px_rgba(74,222,128,0.8)]" id="scoreDisplay">0000</span>
                        </div>
                    </div>

                    <!-- Pantalla de Juego -->
                    <div class="relative bg-black h-[400px] w-full overflow-hidden border-x-4 border-slate-800 shadow-inner cursor-scope">
                        <canvas id="gameCanvas" class="block w-full h-full"></canvas>
                        
                        <!-- Overlay -->
                        <div id="gameOverlay" class="absolute inset-0 bg-black/80 flex flex-col items-center justify-center z-20 text-center p-6 backdrop-blur-sm">
                            <h3 class="text-4xl font-black text-transparent bg-clip-text bg-gradient-to-b from-yellow-300 to-orange-500 mb-2 drop-shadow-lg uppercase italic transform -rotate-2">¡Hora del Recreo!</h3>
                            <p class="text-purple-200 font-mono mb-6 text-sm">Evita que las uvas caigan al suelo.<br>Click para aplastar.</p>
                            
                            <button id="startBtn" class="group relative px-8 py-3 bg-purple-600 hover:bg-purple-500 text-white font-bold rounded-full shadow-[0_4px_0_rgb(88,28,135)] active:shadow-none active:translate-y-[4px] transition-all overflow-hidden">
                                <span class="relative z-10 flex items-center gap-2">
                                    <i data-lucide="play" class="w-5 h-5 fill-current"></i> JUGAR
                                </span>
                                <div class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform"></div>
                            </button>
                            
                            <div class="mt-4 flex gap-4 text-xs text-gray-500 font-mono">
                                <span class="flex items-center gap-1"><div class="w-3 h-3 rounded-full bg-purple-500"></div> +10 PTS</span>
                                <span class="flex items-center gap-1"><div class="w-3 h-3 rounded-full bg-green-500"></div> +20 PTS</span>
                            </div>
                        </div>
                        
                        <!-- HUD In-Game -->
                        <div id="gameHud" class="absolute top-2 left-2 flex gap-1 hidden">
                            <div class="w-3 h-3 rounded-full bg-red-500 animate-pulse"></div>
                            <span class="text-xs text-red-400 font-mono">LIVE</span>
                        </div>
                    </div>

                    <!-- Controles Decorativos -->
                    <div class="bg-slate-800 p-3 rounded-b-lg flex justify-between items-center border-t-2 border-slate-700">
                        <div class="flex gap-2">
                            <div class="w-8 h-8 rounded-full bg-red-600 shadow-[0_3px_0_#991b1b]"></div>
                            <div class="w-8 h-8 rounded-full bg-blue-600 shadow-[0_3px_0_#1e40af]"></div>
                        </div>
                        <div class="text-[10px] text-slate-500 font-mono text-right leading-tight">
                            SOUND: ON<br>SYSTEM READY
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        lucide.createIcons();

        // --- SISTEMA DE AUDIO (Web Audio API) ---
        const AudioSys = {
            ctx: null,
            init: function() {
                if (!this.ctx) {
                    this.ctx = new (window.AudioContext || window.webkitAudioContext)();
                }
            },
            playTone: function(freq, type, duration, vol = 0.1) {
                if (!this.ctx) return;
                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();
                osc.type = type;
                osc.frequency.setValueAtTime(freq, this.ctx.currentTime);
                gain.gain.setValueAtTime(vol, this.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + duration);
                osc.connect(gain);
                gain.connect(this.ctx.destination);
                osc.start();
                osc.stop(this.ctx.currentTime + duration);
            },
            playShoot: function() {
                this.init();
                // Sonido "Pew" rápido
                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();
                osc.frequency.setValueAtTime(600, this.ctx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(100, this.ctx.currentTime + 0.1);
                gain.gain.setValueAtTime(0.1, this.ctx.currentTime);
                gain.gain.linearRampToValueAtTime(0, this.ctx.currentTime + 0.1);
                osc.connect(gain);
                gain.connect(this.ctx.destination);
                osc.start();
                osc.stop(this.ctx.currentTime + 0.1);
            },
            playSplat: function() {
                this.init();
                // Sonido "Squish" (Ruido simulado con ondas bajas)
                this.playTone(150, 'sawtooth', 0.1, 0.1);
                this.playTone(100, 'square', 0.15, 0.05);
            },
            playGameOver: function() {
                this.init();
                this.playTone(300, 'sawtooth', 0.2);
                setTimeout(() => this.playTone(250, 'sawtooth', 0.2), 200);
                setTimeout(() => this.playTone(150, 'sawtooth', 0.6), 400);
            }
        };

        // --- GRÁFICO ---
        const mainDataPoints = [
            { vol: 0.20, cant: 300 }, { vol: 0.50, cant: 120 }, { vol: 0.75, cant: 80 },
            { vol: 1.00, cant: 60 }, { vol: 2.00, cant: 30 }, { vol: 5.00, cant: 12 },
        ];
        const curvePoints = [];
        for (let x = 0.2; x <= 5.5; x += 0.1) curvePoints.push({ x: parseFloat(x.toFixed(1)), y: parseFloat((60 / x).toFixed(1)) });

        const ctx = document.getElementById('wineChart').getContext('2d');
        // Estilo "Mano Alzada" para el gráfico
        Chart.defaults.font.family = '"Patrick Hand", cursive';
        Chart.defaults.font.size = 14;

        const chart = new Chart(ctx, {
            type: 'line',
            data: {
                datasets: [
                    {
                        label: 'Curva', data: curvePoints,
                        borderColor: '#2563eb', borderWidth: 2, pointRadius: 0,
                        tension: 0.4, borderDash: [5, 5] // Línea punteada estilo borrador
                    },
                    {
                        label: 'Puntos', data: mainDataPoints.map(p => ({ x: p.vol, y: p.cant })),
                        backgroundColor: '#dc2626', borderColor: '#fee2e2', borderWidth: 2,
                        pointRadius: 6, pointHoverRadius: 10
                    }
                ]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                scales: {
                    x: { type: 'linear', min: 0, max: 6, grid: { color: '#e2e8f0' }, title: { display: true, text: 'Litros por Envase', font: {size:16} } },
                    y: { min: 0, max: 350, grid: { color: '#e2e8f0' }, title: { display: true, text: 'Cantidad Necesaria', font: {size:16} } }
                },
                plugins: { legend: { display: false }, tooltip: { enabled: false } }, // Tooltip manual
                onHover: (e, els) => {
                    const canvas = e.native.target;
                    canvas.style.cursor = els.length ? 'pointer' : 'default';
                    if(els.length) {
                        const idx = els[0].index;
                        const ds = els[0].datasetIndex;
                        const d = chart.data.datasets[ds].data[idx];
                        updateCalc(d.x, Math.round(d.y));
                    } else {
                        resetCalc();
                    }
                }
            }
        });

        // --- INTERFAZ DE DATOS ---
        const calcBox = {
            def: document.getElementById('calcDefault'),
            act: document.getElementById('calcActive'),
            vol: document.getElementById('valVol'),
            cant: document.getElementById('valCant')
        };
        const tbody = document.getElementById('dataTableBody');

        function updateCalc(v, c) {
            calcBox.def.classList.add('hidden');
            calcBox.act.classList.remove('hidden');
            calcBox.vol.innerText = v.toFixed(2) + ' L';
            calcBox.cant.innerText = c;
            renderTable(v);
        }
        function resetCalc() {
            // No resetear inmediatamente para mejor UX
        }

        function renderTable(activeVol) {
            tbody.innerHTML = '';
            mainDataPoints.forEach(p => {
                const isActive = activeVol && Math.abs(p.vol - activeVol) < 0.1;
                const row = document.createElement('tr');
                row.className = isActive ? 'bg-yellow-100 font-bold text-amber-900' : 'hover:bg-slate-50';
                row.innerHTML = `<td class="p-2">${p.vol} L</td><td class="p-2 text-right">${p.cant}</td>`;
                tbody.appendChild(row);
            });
        }
        renderTable();

        // --- JUEGO (GRAPE SMASH) ---
        const gCanvas = document.getElementById('gameCanvas');
        const gCtx = gCanvas.getContext('2d');
        let width, height;
        let gameLoopId;
        let gameState = 'START'; // START, PLAY, GAME_OVER
        let score = 0;
        let entities = [];
        let particles = [];
        let floaters = [];
        let difficulty = 1;
        let frame = 0;

        function resize() {
            width = gCanvas.width = gCanvas.offsetWidth;
            height = gCanvas.height = gCanvas.offsetHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        // Clases del Juego
        class Grape {
            constructor() {
                this.radius = 20; // Tamaño del hitbox
                this.x = Math.random() * (width - 40) + 20;
                this.y = -30;
                this.speed = (Math.random() * 1.5 + 1) * difficulty;
                this.type = Math.random() > 0.8 ? 'GOLD' : 'PURPLE';
                this.rot = Math.random() * Math.PI;
                this.wobble = Math.random() * 0.1;
            }
            draw(ctx) {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.rotate(Math.sin(frame * 0.05 + this.wobble) * 0.2);
                
                // Dibujar Racimo (3 círculos)
                const color = this.type === 'GOLD' ? '#a3e635' : '#9333ea';
                const dark = this.type === 'GOLD' ? '#65a30d' : '#7e22ce';
                
                // Uva abajo
                this.drawCircle(ctx, 0, 10, 8, color, dark);
                // Uvas arriba
                this.drawCircle(ctx, -7, -2, 9, color, dark);
                this.drawCircle(ctx, 7, -2, 9, color, dark);
                
                // Tallo
                ctx.beginPath();
                ctx.moveTo(0, -10);
                ctx.lineTo(0, -18);
                ctx.strokeStyle = '#4d7c0f';
                ctx.lineWidth = 2;
                ctx.stroke();

                ctx.restore();
            }
            drawCircle(ctx, x, y, r, fill, stroke) {
                ctx.beginPath();
                ctx.arc(x, y, r, 0, Math.PI*2);
                ctx.fillStyle = fill;
                ctx.fill();
                // Brillo
                ctx.beginPath();
                ctx.arc(x - r/3, y - r/3, r/4, 0, Math.PI*2);
                ctx.fillStyle = 'rgba(255,255,255,0.3)';
                ctx.fill();
            }
            update() {
                this.y += this.speed;
                return this.y > height + 20; // Perdió
            }
        }

        class Particle {
            constructor(x, y, color) {
                this.x = x; this.y = y;
                this.vx = (Math.random() - 0.5) * 10;
                this.vy = (Math.random() - 0.5) * 10;
                this.life = 1;
                this.color = color;
                this.gravity = 0.3;
            }
            update() {
                this.x += this.vx;
                this.y += this.vy;
                this.vy += this.gravity;
                this.life -= 0.03;
            }
            draw(ctx) {
                ctx.globalAlpha = this.life;
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, 3, 0, Math.PI*2);
                ctx.fill();
                ctx.globalAlpha = 1;
            }
        }

        class Floater {
            constructor(x, y, text, color) {
                this.x = x; this.y = y;
                this.text = text; this.color = color;
                this.life = 1;
                this.vy = -2;
            }
            update() { this.y += this.vy; this.life -= 0.02; }
            draw(ctx) {
                ctx.globalAlpha = this.life;
                ctx.fillStyle = this.color;
                ctx.font = 'bold 20px "Courier New"';
                ctx.strokeStyle = 'black';
                ctx.lineWidth = 2;
                ctx.strokeText(this.text, this.x, this.y);
                ctx.fillText(this.text, this.x, this.y);
                ctx.globalAlpha = 1;
            }
        }

        // --- LÓGICA DEL JUEGO ---
        function startGame() {
            AudioSys.init();
            document.getElementById('gameOverlay').classList.add('hidden');
            score = 0; difficulty = 1;
            entities = []; particles = []; floaters = [];
            gameState = 'PLAY';
            updateScoreUI();
            loop();
        }

        function gameOver() {
            gameState = 'GAME_OVER';
            AudioSys.playGameOver();
            document.getElementById('gameOverlay').classList.remove('hidden');
            document.querySelector('#gameOverlay h3').innerText = '¡SE CAYÓ!';
            cancelAnimationFrame(gameLoopId);
            
            // Actualizar High Score
            const hs = localStorage.getItem('grape_hs') || 0;
            if (score > hs) {
                localStorage.setItem('grape_hs', score);
                document.getElementById('highScore').innerText = score;
            }
        }

        function updateScoreUI() {
            const el = document.getElementById('scoreDisplay');
            el.innerText = score.toString().padStart(4, '0');
            el.classList.remove('text-green-400');
            void el.offsetWidth; // Trigger reflow
            el.classList.add('text-green-400');
        }

        function drawBackground() {
            // Cielo
            const grad = gCtx.createLinearGradient(0, 0, 0, height);
            grad.addColorStop(0, '#1e1b4b');
            grad.addColorStop(1, '#312e81');
            gCtx.fillStyle = grad;
            gCtx.fillRect(0,0,width,height);
            
            // Viñedo simple (Pixel art procedural)
            gCtx.fillStyle = '#14532d';
            gCtx.beginPath();
            gCtx.moveTo(0, height);
            for(let i=0; i<=width; i+=20) {
                gCtx.lineTo(i, height - 30 - Math.sin(i*0.05)*10);
            }
            gCtx.lineTo(width, height);
            gCtx.fill();
        }

        function loop() {
            if(gameState !== 'PLAY') return;
            frame++;
            gCtx.clearRect(0,0,width,height);
            drawBackground();

            // Spawn
            if(frame % Math.max(20, 60 - Math.floor(score/50)) === 0) {
                entities.push(new Grape());
            }

            // Entidades
            entities = entities.filter(e => {
                e.draw(gCtx);
                const lost = e.update();
                if(lost) gameOver();
                return !lost;
            });

            // Partículas
            particles = particles.filter(p => {
                p.update(); p.draw(gCtx);
                return p.life > 0;
            });

            // Textos Flotantes
            floaters = floaters.filter(f => {
                f.update(); f.draw(gCtx);
                return f.life > 0;
            });

            gameLoopId = requestAnimationFrame(loop);
        }

        // Input
        gCanvas.addEventListener('mousedown', (e) => {
            if(gameState !== 'PLAY') return;
            AudioSys.playShoot();
            const rect = gCanvas.getBoundingClientRect();
            const mx = e.clientX - rect.left;
            const my = e.clientY - rect.top;

            // Efecto disparo
            particles.push(new Particle(mx, my, '#fff'));
            
            // Hitbox check
            for(let i = entities.length - 1; i >= 0; i--) {
                const ent = entities[i];
                const dist = Math.hypot(ent.x - mx, ent.y - my);
                if(dist < 35) { // Hit
                    AudioSys.playSplat();
                    // Sangre/Jugo
                    const color = ent.type === 'GOLD' ? '#bef264' : '#d8b4fe';
                    for(let k=0; k<8; k++) particles.push(new Particle(ent.x, ent.y, color));
                    
                    // Puntos
                    const pts = ent.type === 'GOLD' ? 20 : 10;
                    score += pts;
                    difficulty += 0.05;
                    floaters.push(new Floater(ent.x, ent.y, `+${pts}`, color));
                    
                    entities.splice(i, 1);
                    updateScoreUI();
                    break; // Solo matar uno por click
                }
            }
        });

        document.getElementById('startBtn').addEventListener('click', startGame);
        document.getElementById('highScore').innerText = localStorage.getItem('grape_hs') || 0;

    </script>
</body>
</html>